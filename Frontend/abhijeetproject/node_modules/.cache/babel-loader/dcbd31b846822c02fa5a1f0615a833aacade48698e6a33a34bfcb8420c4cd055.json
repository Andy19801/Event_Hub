{"ast":null,"code":"import{createSlice,createAsyncThunk}from'@reduxjs/toolkit';// Async thunk for changing password\nexport const changePassword=createAsyncThunk('auth/changePassword',async(_ref,_ref2)=>{let{currentPassword,newPassword}=_ref;let{rejectWithValue,getState}=_ref2;try{const response=await fetch('/api/change-password',{method:'POST',headers:{'Content-Type':'application/json','Authorization':`Bearer ${getState().auth.token}`// Include token if needed\n},body:JSON.stringify({currentPassword,newPassword})});if(!response.ok){throw new Error('Failed to change password');}const data=await response.json();return data;// Adjust based on your API response\n}catch(error){return rejectWithValue(error.message);}});// Async thunk for changing profile picture\nexport const changeProfilePic=createAsyncThunk('auth/changeProfilePic',async(formData,_ref3)=>{let{rejectWithValue,getState}=_ref3;try{const response=await fetch('/api/change-profile-pic',{method:'POST',body:formData,headers:{'Authorization':`Bearer ${getState().auth.token}`// Include token if needed\n}});if(!response.ok){throw new Error('Failed to upload profile picture');}const data=await response.json();return data;// Adjust based on your API response\n}catch(error){return rejectWithValue(error.message);}});const initialState={user:null,token:localStorage.getItem('authToken')||null,changePasswordStatus:'idle',changePasswordError:null,changeProfilePicStatus:'idle',changeProfilePicError:null};const authSlice=createSlice({name:'auth',initialState,reducers:{setCredentials:(state,action)=>{const{user,token}=action.payload;state.user=user;state.token=token;localStorage.setItem('authToken',token);},logout:state=>{state.user=null;state.token=null;localStorage.removeItem('authToken');}},extraReducers:builder=>{builder.addCase(changePassword.pending,state=>{state.changePasswordStatus='loading';state.changePasswordError=null;}).addCase(changePassword.fulfilled,state=>{state.changePasswordStatus='succeeded';state.changePasswordError=null;}).addCase(changePassword.rejected,(state,action)=>{state.changePasswordStatus='failed';state.changePasswordError=action.payload;}).addCase(changeProfilePic.pending,state=>{state.changeProfilePicStatus='loading';state.changeProfilePicError=null;}).addCase(changeProfilePic.fulfilled,(state,action)=>{state.changeProfilePicStatus='succeeded';state.changeProfilePicError=null;// Assuming the response includes the updated user data\nstate.user=action.payload.user;}).addCase(changeProfilePic.rejected,(state,action)=>{state.changeProfilePicStatus='failed';state.changeProfilePicError=action.payload;});}});export const{setCredentials,logout}=authSlice.actions;export default authSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","changePassword","_ref","_ref2","currentPassword","newPassword","rejectWithValue","getState","response","fetch","method","headers","auth","token","body","JSON","stringify","ok","Error","data","json","error","message","changeProfilePic","formData","_ref3","initialState","user","localStorage","getItem","changePasswordStatus","changePasswordError","changeProfilePicStatus","changeProfilePicError","authSlice","name","reducers","setCredentials","state","action","payload","setItem","logout","removeItem","extraReducers","builder","addCase","pending","fulfilled","rejected","actions","reducer"],"sources":["G:/Event Event Hub/Frontend/abhijeetproject/src/features/auth/authSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\r\n\r\n// Async thunk for changing password\r\nexport const changePassword = createAsyncThunk(\r\n  'auth/changePassword',\r\n  async ({ currentPassword, newPassword }, { rejectWithValue, getState }) => {\r\n    try {\r\n      const response = await fetch('/api/change-password', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Authorization': `Bearer ${getState().auth.token}`, // Include token if needed\r\n        },\r\n        body: JSON.stringify({ currentPassword, newPassword }),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Failed to change password');\r\n      }\r\n\r\n      const data = await response.json();\r\n      return data; // Adjust based on your API response\r\n    } catch (error) {\r\n      return rejectWithValue(error.message);\r\n    }\r\n  }\r\n);\r\n\r\n// Async thunk for changing profile picture\r\nexport const changeProfilePic = createAsyncThunk(\r\n  'auth/changeProfilePic',\r\n  async (formData, { rejectWithValue, getState }) => {\r\n    try {\r\n      const response = await fetch('/api/change-profile-pic', {\r\n        method: 'POST',\r\n        body: formData,\r\n        headers: {\r\n          'Authorization': `Bearer ${getState().auth.token}`, // Include token if needed\r\n        },\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Failed to upload profile picture');\r\n      }\r\n\r\n      const data = await response.json();\r\n      return data; // Adjust based on your API response\r\n    } catch (error) {\r\n      return rejectWithValue(error.message);\r\n    }\r\n  }\r\n);\r\n\r\nconst initialState = {\r\n  user: null,\r\n  token: localStorage.getItem('authToken') || null,\r\n  changePasswordStatus: 'idle',\r\n  changePasswordError: null,\r\n  changeProfilePicStatus: 'idle',\r\n  changeProfilePicError: null,\r\n};\r\n\r\nconst authSlice = createSlice({\r\n  name: 'auth',\r\n  initialState,\r\n  reducers: {\r\n    setCredentials: (state, action) => {\r\n      const { user, token } = action.payload;\r\n      state.user = user;\r\n      state.token = token;\r\n      localStorage.setItem('authToken', token);\r\n    },\r\n    logout: (state) => {\r\n      state.user = null;\r\n      state.token = null;\r\n      localStorage.removeItem('authToken');\r\n    },\r\n  },\r\n  extraReducers: (builder) => {\r\n    builder\r\n      .addCase(changePassword.pending, (state) => {\r\n        state.changePasswordStatus = 'loading';\r\n        state.changePasswordError = null;\r\n      })\r\n      .addCase(changePassword.fulfilled, (state) => {\r\n        state.changePasswordStatus = 'succeeded';\r\n        state.changePasswordError = null;\r\n      })\r\n      .addCase(changePassword.rejected, (state, action) => {\r\n        state.changePasswordStatus = 'failed';\r\n        state.changePasswordError = action.payload;\r\n      })\r\n      .addCase(changeProfilePic.pending, (state) => {\r\n        state.changeProfilePicStatus = 'loading';\r\n        state.changeProfilePicError = null;\r\n      })\r\n      .addCase(changeProfilePic.fulfilled, (state, action) => {\r\n        state.changeProfilePicStatus = 'succeeded';\r\n        state.changeProfilePicError = null;\r\n        // Assuming the response includes the updated user data\r\n        state.user = action.payload.user;\r\n      })\r\n      .addCase(changeProfilePic.rejected, (state, action) => {\r\n        state.changeProfilePicStatus = 'failed';\r\n        state.changeProfilePicError = action.payload;\r\n      });\r\n  },\r\n});\r\n\r\nexport const { setCredentials, logout } = authSlice.actions;\r\nexport default authSlice.reducer;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}